<div class="w-full mx-auto max-w-3xl flex  justify-center items-center mt-32 mb-8">
    <p-card class="w-full" header="Add new book">
        <form [formGroup]=" newBookForm" (ngSubmit)="onSubmit()" class="w-full">
            <div class="space-y-2.5">

                <div class="flex flex-col-reverse md:flex-row w-full md:gap-4 h-full">

                    <div class="flex flex-col gap-1 w-full md:w-3/5  ">
                        <label for="bookDescription">Book description*</label>

                        <textarea id="bookDescription" class="w-full p-2 rounded-md min-h-20 max-h-[220px] h-[220px]"
                            formControlName="bookDescription" placeholder="book description" rows="5" cols="30"
                            pInputTextarea formControlName="bookDescription">
                        </textarea>



                        @if(! newBookForm.controls.bookDescription.valid &&
                        newBookForm.controls.bookDescription.touched){
                        <div>
                            @if ( newBookForm.controls.bookDescription.getError("required")) {
                            <app-input-error-message message="Book description is required" />
                            }
                        </div>
                        }
                    </div>

                    <div class="flex flex-col gap-1 w-full md:w-2/5 ">
                        <label for="author">Author*</label>
                        @if (authors) {
                        <p-listbox [options]="authors" formControlName="authorId" optionLabel="fullName"
                            [style]="{'width':'100%'}" [listStyle]="{'max-height': '220px'}" />
                        }
                    </div>




                </div>





                <div class="flex flex-col gap-1 ">
                    <label for="title">Ttile*</label>

                    <input placeholder="title"
                        [ngClass]="! newBookForm.controls.title.valid &&  newBookForm.controls.title.touched?'ng-invalid ng-dirty':''"
                        id="title" class="w-full" type="text" pInputText formControlName="title" />

                    @if(! newBookForm.controls.title.valid && newBookForm.controls.title.touched){
                    <div>
                        @if ( newBookForm.controls.title.getError("required")) {
                        <app-input-error-message message="Title is required" />
                        }
                    </div>
                    }
                </div>




                <div class="flex-col md:flex-row flex w-full md:gap-2">

                    <div class="w-full md:space-y-2">

                        <div class="flex flex-col gap-1 ">
                            <label for="numberOfPages">Number of pages*</label>

                            <p-inputNumber placeholder="Number of pages" [style]="{'width':'100%'}" min="1" max="5000"
                                [inputStyle]="{'width':'100%'}"
                                [ngClass]="! newBookForm.controls.numberOfPages.valid &&  newBookForm.controls.numberOfPages.touched?'ng-invalid ng-dirty':''"
                                id="numberOfPages" class="w-full" formControlName="numberOfPages" />

                            @if(! newBookForm.controls.numberOfPages.valid &&
                            newBookForm.controls.numberOfPages.touched){
                            <div>
                                @if ( newBookForm.controls.numberOfPages.getError("required")) {
                                <app-input-error-message message="Number of pages is required" />
                                }
                            </div>
                            }
                        </div>

                        <div class="flex flex-col gap-1 ">
                            <label for="avaibleCopies">Avaible copies*</label>

                            <p-inputNumber placeholder="Avaible copies" [style]="{'width':'100%'}" min="0" max="100"
                                [inputStyle]="{'width':'100%'}"
                                [ngClass]="! newBookForm.controls.availableCopies.valid &&  newBookForm.controls.availableCopies.touched?'ng-invalid ng-dirty':''"
                                id="availableCopies" class="w-full" formControlName="availableCopies" />

                            @if(! newBookForm.controls.availableCopies.valid &&
                            newBookForm.controls.availableCopies.touched){
                            <div>
                                @if ( newBookForm.controls.availableCopies.getError("required")) {
                                <app-input-error-message message="Avaible copies is required" />
                                }
                            </div>
                            }
                        </div>

                    </div>

                    <div class="w-full md:space-y-2">


                        <div class="flex flex-col gap-1 ">
                            <label for="date">Publication Date*</label>
                            <p-calendar placeholder="Publication Date" inputId="date" formControlName="publicationDate"
                                class="w-full" [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}" />
                        </div>


                        <div class="flex flex-col gap-1 ">
                            <label for="categoriesIds">Categroies</label>
                            @if (categories) {
                            <p-multiSelect [options]="categories.categories" formControlName="categoriesIds"
                                optionLabel="name" placeholder="Select categories" [style]="{'width':'100%'}" />
                            }
                        </div>

                    </div>
                </div>
                <div class="flex flex-col gap-1 ">
                    <label for="image">Image</label>
                    <input accept="image/*" type="file" (change)="onChangeImage($event)" />
                </div>


            </div>

            <div class="mt-6">
                <p-button iconPos="right" [loading]="isLoading" [disabled]="!newBookForm.valid" type="submit"
                    [label]=" isLoading? 'Creating. Plase wait':'Add Book'" class="w-full" styleClass="w-full" />
            </div>
        </form>

        <ng-template pTemplate="footer">
            <div class="flex  justify-center items-center">
                <p class="text-sm text-gray-300">* Fileds are required </p>
            </div>
        </ng-template>
    </p-card>
</div>